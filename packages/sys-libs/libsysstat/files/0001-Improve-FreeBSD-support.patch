From afab90ac7d20386b671452a0e7207e152807d1e3 Mon Sep 17 00:00:00 2001
From: "Hong Jen Yee (PCMan)" <pcman.tw@gmail.com>
Date: Fri, 9 May 2014 00:38:24 +0800
Subject: [PATCH 1/4] Improve FreeBSD support

---
 cmake/create_pkgconfig_file.cmake | 13 ++++++++++---
 cmake/sysstat-config.cmake.in     |  3 +++
 cmake/sysstat_use.cmake           |  2 +-
 3 files changed, 14 insertions(+), 4 deletions(-)

diff --git a/cmake/create_pkgconfig_file.cmake b/cmake/create_pkgconfig_file.cmake
index 96ac25a..fbbd6f5 100644
--- a/cmake/create_pkgconfig_file.cmake
+++ b/cmake/create_pkgconfig_file.cmake
@@ -9,18 +9,25 @@ macro (create_pkgconfig_file name desc)
     #message(STATUS "${name}: writing pkgconfig file ${_pkgfname}")
 
     file(WRITE "${_pkgfname}"
-            "# file generated by razor-qt cmake build\n"
+            "# file generated by LXQt cmake build\n"
             "prefix=${CMAKE_INSTALL_PREFIX}\n"
             "libdir=\${prefix}/lib${LIB_SUFFIX}\n"
             "includedir=\${prefix}/include\n"
             "\n"
             "Name: ${name}\n"
             "Description: ${desc}\n"
-            "Version: ${RAZOR_VERSION}\n"
+            "Version: ${LXQT_VERSION}\n"
             "Libs: -L\${libdir} -l${name}\n"
             "Cflags: -I\${includedir}\n"
             "\n"
     )
 
-    install(FILES ${_pkgfname} DESTINATION lib${LIB_SUFFIX}/pkgconfig)
+    # FreeBSD loves to install files to different locations
+    # http://www.freebsd.org/doc/handbook/dirstructure.html
+    if(${CMAKE_SYSTEM_NAME} STREQUAL "FreeBSD")
+        install(FILES ${_pkgfname} DESTINATION libdata/pkgconfig)
+    else()
+        install(FILES ${_pkgfname} DESTINATION lib${LIB_SUFFIX}/pkgconfig)
+    endif()
+
 endmacro()
diff --git a/cmake/sysstat-config.cmake.in b/cmake/sysstat-config.cmake.in
index 7177206..57d1921 100644
--- a/cmake/sysstat-config.cmake.in
+++ b/cmake/sysstat-config.cmake.in
@@ -8,6 +8,8 @@
 #
 #  SYSSTAT_INCLUDE_DIRS  - The lxqt and the Qt include directory, for use with INCLUDE_DIRECTORIES()
 #
+#  SYSSTAT_LIBRARY_DIRS  - The lxqt and the Qt library directory
+#
 #  SYSSTAT_LIBRARIES     - The libraries needed to use lxqt
 #
 #  SYSSTAT_USE_FILE       - The variable SYSSTAT_USE_FILE is set which is the path to a CMake file that
@@ -25,6 +27,7 @@ set(SYSSTAT_LIBRARY       sysstat)
 
 set(SYSSTAT_LIBRARIES     ${SYSSTAT_LIBRARY} )
 set(SYSSTAT_INCLUDE_DIRS  ${SYSSTAT_INCLUDE_DIR} )
+set(SYSSTAT_LIBRARY_DIRS  @CMAKE_INSTALL_PREFIX@/@LIB_INSTALL_DIR@ )
 set(SYSSTAT_USE_FILE      ${CMAKE_CURRENT_LIST_DIR}/sysstat_use.cmake)
 set(SYSSTAT_FOUND         1)
 
diff --git a/cmake/sysstat_use.cmake b/cmake/sysstat_use.cmake
index 8b13789..042679c 100644
--- a/cmake/sysstat_use.cmake
+++ b/cmake/sysstat_use.cmake
@@ -1 +1 @@
-
+link_directories(${SYSSTAT_LIBRARY_DIRS})
-- 
2.1.2

